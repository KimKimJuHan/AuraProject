name: Game Data Collector

on:
  schedule:
    - cron: '0 15 * * *' # ë§¤ì¼ í•œêµ­ì‹œê°„ 00:00 (UTC 15:00)
  workflow_dispatch: # ìˆ˜ë™ ì‹¤í–‰ ê°€ëŠ¥

jobs:
  build:
    runs-on: ubuntu-latest

    steps:
    - name: Checkout code
      uses: actions/checkout@v3

    - name: Setup Node.js
      uses: actions/setup-node@v3
      with:
        node-version: '18'

    - name: Install Dependencies
      run: |
        cd backend
        npm install

    - name: Run Collector
      run: node backend/collector.js
      env:
        # ğŸ‘‡ ì—¬ê¸°ì— GitHub Secretsì— ë“±ë¡í•œ í‚¤ë“¤ì„ ì—°ê²°í•©ë‹ˆë‹¤.
        MONGODB_URI: ${{ secrets.MONGODB_URI }}
        ITAD_API_KEY: ${{ secrets.ITAD_API_KEY }}
        TWITCH_CLIENT_ID: ${{ secrets.TWITCH_CLIENT_ID }}
        TWITCH_CLIENT_SECRET: ${{ secrets.TWITCH_CLIENT_SECRET }}
        CHZZK_CLIENT_ID: ${{ secrets.CHZZK_CLIENT_ID }}
        CHZZK_CLIENT_SECRET: ${{ secrets.CHZZK_CLIENT_SECRET }}